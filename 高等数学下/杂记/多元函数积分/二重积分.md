# [[二重积分]]

## 1. 从体积角度理解

*   **类比一重积分：** 回想一下，定积分 $\int_a^b f(x) \, dx$ (当 $f(x) \ge 0$ 时) 可以理解为由曲线 $y=f(x)$、直线 $x=a$、$x=b$ 以及 $x$ 轴所围成的平面区域的**面积**。
*   **推广到二重积分：** 类似地，二重积分 $\iint_D f(x, y) \, dA$ (当 $f(x, y) \ge 0$ 时) 可以理解为由曲面 $z=f(x, y)$、柱面（边界由区域 $D$ 的边界竖直延伸形成）以及 $xy$ 平面上的区域 $D$ 所围成的**空间几何体的体积**。
    *   **想象一下：** 区域 $D$ 是地面上的一块区域。函数 $f(x, y)$ 代表在点 $(x, y)$ 处的海拔高度。
    *   我们将区域 $D$ 分割成很多很多微小的矩形区域 $\Delta A_i$。
    *   在每个小区域 $\Delta A_i$ 上，取一个点 $(x_i^*, y_i^*)$，对应的高度是 $f(x_i^*, y_i^*)$。
    *   那么 $f(x_i^*, y_i^*) \Delta A_i$ 就近似于以 $\Delta A_i$ 为底、高为 $f(x_i^*, y_i^*)$ 的一个细长立方柱的体积。
    *   将所有这些小立方柱的体积加起来 $\sum f(x_i^*, y_i^*) \Delta A_i$，就近似得到了曲面 $z=f(x, y)$ 下方、区域 $D$ 上方的体积。
    *   当分割无限细化，即 $\Delta A_i \to 0$ 时，这个和的极限就是精确的体积，也就是二重积分 $\iint_D f(x, y) \, dA$。

## 2. 从面密度角度理解

*   **场景：** 考虑一个占据 $xy$ 平面上区域 $D$ 的薄板（或称为“质心薄片”，lamina）。
*   **面密度：** 假设这个薄板的密度不是均匀的，在点 $(x, y)$ 处的面密度（单位面积的质量）为 $\rho(x, y)$。
*   **微元质量：** 将区域 $D$ 分割成很多微小的区域 $\Delta A_i$。在每个小区域 $\Delta A_i$ 上，可以认为密度近似为常数，取该区域内某点 $(x_i^*, y_i^*)$ 的密度 $\rho(x_i^*, y_i^*)$。那么这块小区域的质量 $\Delta m_i$ 就近似等于 $\rho(x_i^*, y_i^*) \Delta A_i$ （质量 = 密度 × 面积）。
*   **总质量：** 整个薄板的总质量 $M$ 就是所有这些小块质量之和的极限，即 $M = \lim_{\Delta A_i \to 0} \sum \rho(x_i^*, y_i^*) \Delta A_i$。
*   **积分表示：** 这个极限正是二重积分的定义，所以薄板的总质量为 $M = \iint_D \rho(x, y) \, dA$。

## 3. 二重积分的本质

二重积分的本质是**对一个定义在二维区域上的函数进行“累加”**。这个“累加”是针对区域进行的，而不是像一重积分那样沿着一条线段进行。

*   它将一个二维区域 $D$ 分割成无穷多个无穷小的面积微元 $dA$。
*   在每个面积微元上，取函数 $f(x, y)$ 的值（可以代表高度、密度、或其他物理量）。
*   将函数值 $f(x, y)$ 与对应的面积微元 $dA$ 相乘，得到该微元对总量的贡献 $f(x, y) \, dA$。
*   最后将所有这些无穷小的贡献“加”起来（积分的本质就是求和的极限），得到函数 $f(x, y)$ 在整个区域 $D$ 上的总和或累积效果。

所以，无论是计算体积（累加“高度 $\times$ 底面积”）还是计算质量（累加“密度 $\times$ 面积”），其核心思想都是一样的：**在一个面上对一个量进行加权求和**，权重就是面积微元 $dA$。

## 4. 数学严谨定义

设 $f(x, y)$ 是定义在 $xy$ 平面上的有界闭区域 $D$ 上的函数。

1.  **分割：** 用任意一组曲线网将区域 $D$ 分割成 $n$ 个小区域 $\Delta \sigma_1, \Delta \sigma_2, \dots, \Delta \sigma_n$。这些小区域的面积分别记为 $\Delta A_1, \Delta A_2, \dots, \Delta A_n$。
2.  **取点：** 在每个小区域 $\Delta \sigma_i$ 上任取一点 $(\xi_i, \eta_i)$。
3.  **作和：** 计算黎曼和 (Riemann Sum): $S_n = \sum_{i=1}^n f(\xi_i, \eta_i) \Delta A_i$。
4.  **取极限：** 记 $\lambda$ 为所有小区域 $\Delta \sigma_i$ 的直径（区域内任意两点距离的最大值）中的最大值。如果当 $\lambda \to 0$ 时，无论对 $D$ 如何分割，以及在 $\Delta \sigma_i$ 上如何取点 $(\xi_i, \eta_i)$，黎曼和 $S_n$ 都趋于同一个确定的极限 $I$，则称函数 $f(x, y)$ 在区域 $D$ 上可积，这个极限 $I$ 称为函数 $f(x, y)$ 在区域 $D$ 上的二重积分，记作：
    $$ \iint_D f(x, y) \, dA = \lim_{\lambda \to 0} \sum_{i=1}^n f(\xi_i, \eta_i) \Delta A_i $$
    其中 $dA$ (或 $d\sigma$) 称为**面积元素**。如果 $f(x, y)$ 在有界闭区域 $D$ 上连续，则 $f(x, y)$ 在 $D$ 上一定可积。

## 5. 二重积分的性质

设函数 $f(x, y)$ 和 $g(x, y)$ 在区域 $D$ 上可积， $k$ 为常数。

1.  **被积函数为 1：** $\iint_D 1 \, dA = \text{Area}(D)$ （区域 $D$ 的面积）。
2.  **线性性质：**
    *   $\iint_D k f(x, y) \, dA = k \iint_D f(x, y) \, dA$
    *   $\iint_D [f(x, y) \pm g(x, y)] \, dA = \iint_D f(x, y) \, dA \pm \iint_D g(x, y) \, dA$
3.  **区域可加性：** 如果区域 $D$ 被分成两个子区域 $D_1$ 和 $D_2$ ($D = D_1 \cup D_2$)，它们没有内部公共点，则：
    $$ \iint_D f(x, y) \, dA = \iint_{D_1} f(x, y) \, dA + \iint_{D_2} f(x, y) \, dA $$
4.  **保序性（比较性质）：** 如果在 $D$ 上 $f(x, y) \ge g(x, y)$，则 $\iint_D f(x, y) \, dA \ge \iint_D g(x, y) \, dA$。
    *   **推论：** 如果在 $D$ 上 $f(x, y) \ge 0$，则 $\iint_D f(x, y) \, dA \ge 0$。
5.  **估值性质：** 设 $M$ 和 $m$ 分别是 $f(x, y)$ 在区域 $D$ 上的最大值和最小值， $A$ 是 $D$ 的面积，则：
    $$ m \cdot A \le \iint_D f(x, y) \, dA \le M \cdot A $$
6.  **中值定理：** 如果 $f(x, y)$ 在连通的闭区域 $D$ 上连续，则在 $D$ 上至少存在一点 $(\xi, \eta)$，使得：
    $$ \iint_D f(x, y) \, dA = f(\xi, \eta) \cdot \text{Area}(D) $$

## 6. 二重积分的计算方法

### 6.1 利用直角坐标计算

这是最基本和常用的方法。关键在于根据积分区域 $D$ 的形状，确定合适的积分次序（先对 $y$ 积分还是先对 $x$ 积分）以及相应的积分限。

#### 6.1.1 情况一：X-型区域 (Type I Region)

如果积分区域 $D$ 可以被描述为：
$D = \{ (x, y) \mid a \le x \le b, \, g_1(x) \le y \le g_2(x) \}$
其中 $g_1(x)$ 和 $g_2(x)$ 是在 $[a, b]$ 上的连续函数。这意味着对于每个固定的 $x$ 值（在 $a$ 和 $b$ 之间），$y$ 的取值范围是从下边界曲线 $y=g_1(x)$ 到上边界曲线 $y=g_2(x)$。

![Type I Region](https://math.libretexts.org/@api/deki/files/7900/5.2.1.png?revision=1&size=bestfit&width=359&height=286)

在这种情况下，二重积分可以转化为**累次积分**：
$$ \iint_D f(x, y) \, dA = \int_a^b \left[ \int_{g_1(x)}^{g_2(x)} f(x, y) \, dy \right] dx $$
**计算步骤：**
1.  **内层积分：** 先计算关于 $y$ 的定积分 $\int_{g_1(x)}^{g_2(x)} f(x, y) \, dy$。在这一步中，将 $x$ 视为常数。积分结果通常是一个关于 $x$ 的函数，记作 $A(x)$。
2.  **外层积分：** 再计算关于 $x$ 的定积分 $\int_a^b A(x) \, dx$。

#### 6.1.2 情况二：Y-型区域 (Type II Region)

如果积分区域 $D$ 可以被描述为：
$D = \{ (x, y) \mid c \le y \le d, \, h_1(y) \le x \le h_2(y) \}$
其中 $h_1(y)$ 和 $h_2(y)$ 是在 $[c, d]$ 上的连续函数。这意味着对于每个固定的 $y$ 值（在 $c$ 和 $d$ 之间），$x$ 的取值范围是从左边界曲线 $x=h_1(y)$ 到右边界曲线 $x=h_2(y)$。

![Type II Region](https://math.libretexts.org/@api/deki/files/7901/5.2.2.png?revision=1&size=bestfit&width=361&height=286)

在这种情况下，二重积分可以转化为累次积分：
$$ \iint_D f(x, y) \, dA = \int_c^d \left[ \int_{h_1(y)}^{h_2(y)} f(x, y) \, dx \right] dy $$
**计算步骤：**
1.  **内层积分：** 先计算关于 $x$ 的定积分 $\int_{h_1(y)}^{h_2(y)} f(x, y) \, dx$。在这一步中，将 $y$ 视为常数。积分结果通常是一个关于 $y$ 的函数，记作 $B(y)$。
2.  **外层积分：** 再计算关于 $y$ 的定积分 $\int_c^d B(y) \, dy$。

#### 6.1.3 矩形区域

如果区域 $D$ 是一个矩形 $D = [a, b] \times [c, d]$，即 $a \le x \le b, c \le y \le d$，那么它既是 X-型区域也是 Y-型区域。根据**富比尼定理 (Fubini's Theorem)**，如果 $f(x, y)$ 在 $D$ 上连续，积分次序可以任意交换：
$$ \iint_D f(x, y) \, dA = \int_a^b \int_c^d f(x, y) \, dy \, dx = \int_c^d \int_a^b f(x, y) \, dx \, dy $$

#### 6.1.4 选择积分次序

对于非矩形区域，有时只能用一种类型的描述（X-型或Y-型），有时两种都可以。选择哪种次序取决于：
1.  **区域描述的简便性：** 哪种方式能用更简单的函数描述边界。
2.  **被积函数的积分难易度：** $f(x, y)$ 对哪个变量积分更容易。有时一种积分次序会导致内层积分无法用初等函数表达，而换一种次序则可以。
3.  **复杂区域：** 可能需要将区域 $D$ 分割成几个简单的 X-型或 Y-型子区域，分别计算积分再相加。

### 6.2 利用极坐标计算

当积分区域 $D$ 是圆形、扇形、环形或部分环形，或者被积函数 $f(x, y)$ 包含 $x^2+y^2$、$\frac{y}{x}$ 等形式时，转换为极坐标计算通常更简便。

#### 6.2.1 坐标变换

$x = r \cos \theta$
$y = r \sin \theta$

#### 6.2.2 面积元素

在极坐标下，面积元素 $dA = dx \, dy$ 变为 $dA = r \, dr \, d\theta$。
**非常重要：** 不要忘记乘以雅可比行列式的绝对值 $r$。

#### 6.2.3 积分变换公式

$$ \iint_D f(x, y) \, dA = \iint_{D^*} f(r \cos \theta, r \sin \theta) \, r \, dr \, d\theta $$
其中 $D^*$ 是区域 $D$ 在极坐标系 $(r, \theta)$ 下的表示。

#### 6.2.4 确定积分限

通常，极坐标区域 $D^*$ 可以表示为：
$D^* = \{ (r, \theta) \mid \alpha \le \theta \le \beta, \, g_1(\theta) \le r \le g_2(\theta) \}$
这意味着 $\theta$ 从 $\alpha$ 变化到 $\beta$，对于每个固定的 $\theta$， $r$ 从内边界 $r=g_1(\theta)$ 变化到外边界 $r=g_2(\theta)$。
此时，累次积分为：
$$ \iint_{D^*} f(r \cos \theta, r \sin \theta) \, r \, dr \, d\theta = \int_\alpha^\beta \left[ \int_{g_1(\theta)}^{g_2(\theta)} f(r \cos \theta, r \sin \theta) \, r \, dr \right] d\theta $$
**计算步骤：**
1.  **内层积分：** 先对 $r$ 积分，将 $\theta$ 视为常数。
2.  **外层积分：** 再对 $\theta$ 积分。

#### 6.2.5 常见极坐标区域

*   **圆域** $x^2+y^2 \le R^2$： $D^* = \{ (r, \theta) \mid 0 \le \theta \le 2\pi, \, 0 \le r \le R \}$
*   **圆环域** $R_1^2 \le x^2+y^2 \le R_2^2$： $D^* = \{ (r, \theta) \mid 0 \le \theta \le 2\pi, \, R_1 \le r \le R_2 \}$
*   **扇形域**（顶点在原点）： $D^* = \{ (r, \theta) \mid \alpha \le \theta \le \beta, \, 0 \le r \le R(\theta) \}$

### 6.3 利用换元法（变量替换）

这是更一般的方法，极坐标是其特例。如果通过变量替换 $x=x(u, v), y=y(u, v)$，可以将 $xy$ 平面上的复杂区域 $D$ 变换为 $uv$ 平面上更简单的区域 $D^*$（如矩形），并且简化被积函数，那么可以使用换元法。

#### 6.3.1 雅可比行列式 (Jacobian)

$$ J(u, v) = \det \begin{pmatrix} \frac{\partial x}{\partial u} & \frac{\partial x}{\partial v} \\ \frac{\partial y}{\partial u} & \frac{\partial y}{\partial v} \end{pmatrix} = \frac{\partial x}{\partial u} \frac{\partial y}{\partial v} - \frac{\partial x}{\partial v} \frac{\partial y}{\partial u} $$

#### 6.3.2 面积元素变换

$dA = dx \, dy = |J(u, v)| \, du \, dv$。

#### 6.3.3 积分变换公式

$$ \iint_D f(x, y) \, dx \, dy = \iint_{D^*} f(x(u, v), y(u, v)) \, |J(u, v)| \, du \, dv $$

#### 6.3.4 计算步骤

1.  选择合适的变量替换 $u=u(x,y), v=v(x,y)$ 或 $x=x(u,v), y=y(u,v)$。
2.  确定新区域 $D^*$ 在 $uv$ 平面上的边界和积分限。
3.  计算雅可比行列式 $J(u, v)$ 及其绝对值 $|J(u, v)|$。
4.  将被积函数 $f(x, y)$ 用 $u, v$ 表示。
5.  在新坐标系下建立并计算累次积分 $\iint_{D^*} F(u, v) |J(u, v)| \, du \, dv$。

### 6.4 计算步骤总结

1.  **画图：** 绘制积分区域 $D$ 的草图，这是最关键的一步，有助于确定边界和选择合适的坐标系及积分次序。
2.  **选择坐标系：** 根据区域 $D$ 的形状和被积函数 $f(x, y)$ 的特点，选择直角坐标或极坐标（或更一般的坐标变换）。
3.  **确定积分限：**
    *   **直角坐标：** 确定是 X-型还是 Y-型区域，写出 $x$ 和 $y$ 的积分限。可能需要分割区域。
    *   **极坐标：** 确定 $\theta$ 和 $r$ 的积分限。
4.  **建立累次积分：** 写出带有正确积分限和面积元素（$dx dy$, $dy dx$, 或 $r dr d\theta$）的累次积分表达式。
5.  **计算积分：** 按照从内到外的顺序计算定积分。

**选择合适的计算方法和积分次序往往能大大简化计算过程。**

## 7. 二重积分的特殊计算方法

### 7.1 利用对称性简化计算

在计算二重积分时，如果积分区域 $D$ 和被积函数 $f(x, y)$ 具有某些对称性，可以大大简化计算过程。

#### 7.1.1 利用奇偶性 (Parity)

*   **区域关于 y 轴对称：**
    设区域 $D$ 关于 y 轴对称，即若 $(x, y) \in D$，则 $(-x, y) \in D$。
    *   若 $f(x, y)$ 是关于 $x$ 的**奇函数**，即 $f(-x, y) = -f(x, y)$，则：
        $$ \iint_D f(x, y) \, dA = 0 $$
        (直观理解：对称区域上，关于 $x$ 一正一负的函数值相互抵消。)
    *   若 $f(x, y)$ 是关于 $x$ 的**偶函数**，即 $f(-x, y) = f(x, y)$，则：
        $$ \iint_D f(x, y) \, dA = 2 \iint_{D_1} f(x, y) \, dA $$
        其中 $D_1$ 是 $D$ 在 $y$ 轴右侧（或左侧）的部分，即 $D_1 = D \cap \{ (x, y) \mid x \ge 0 \}$ (或 $x \le 0$)。
        (直观理解：只计算一半区域的积分，结果乘以 2。)

*   **区域关于 x 轴对称：**
    设区域 $D$ 关于 x 轴对称，即若 $(x, y) \in D$，则 $(x, -y) \in D$。
    *   若 $f(x, y)$ 是关于 $y$ 的**奇函数**，即 $f(x, -y) = -f(x, y)$，则：
        $$ \iint_D f(x, y) \, dA = 0 $$
    *   若 $f(x, y)$ 是关于 $y$ 的**偶函数**，即 $f(x, -y) = f(x, y)$，则：
        $$ \iint_D f(x, y) \, dA = 2 \iint_{D_2} f(x, y) \, dA $$
        其中 $D_2$ 是 $D$ 在 $x$ 轴上方（或下方）的部分，即 $D_2 = D \cap \{ (x, y) \mid y \ge 0 \}$ (或 $y \le 0$)。

*   **区域关于原点对称：**
    如果区域 $D$ 同时关于 x 轴和 y 轴对称（因而也关于原点对称），可以结合使用上述性质。例如，若 $f(x, y)$ 关于 $x$ 是奇函数**或**关于 $y$ 是奇函数，则积分为 0。若 $f(x, y)$ 同时关于 $x$ 和 $y$ 都是偶函数，则：
    $$ \iint_D f(x, y) \, dA = 4 \iint_{D_{1q}} f(x, y) \, dA $$
    其中 $D_{1q}$ 是 $D$ 在第一象限的部分。

#### 7.1.2 利用轮换对称性 (Symmetry about y=x)

*   **条件：** 设积分区域 $D$ 关于直线 $y=x$ 对称，即若 $(x, y) \in D$，则 $(y, x) \in D$。
*   **结论：** 在这种条件下，对 $x$ 和 $y$ 互换，积分值不变：
    $$ \iint_D f(x, y) \, dA = \iint_D f(y, x) \, dA $$
    (可以通过变量替换 $u=y, v=x$ 来证明，雅可比行列式绝对值为 1，积分区域不变。)
*   **妙用：**
    *   **求和/差：**
        $$ \iint_D [f(x, y) + f(y, x)] \, dA = 2 \iint_D f(x, y) \, dA = 2 \iint_D f(y, x) \, dA $$
        $$ \iint_D [f(x, y) - f(y, x)] \, dA = 0 $$
    *   **简化计算：** 如果被积函数形如 $g(x, y) + g(y, x)$，可以只计算 $\iint_D g(x, y) \, dA$ 再乘以 2。
    *   **特殊情况：** 计算 $\iint_D x \, dA$ 和 $\iint_D y \, dA$。如果区域 $D$ 关于 $y=x$ 对称，则：
        $$ \iint_D x \, dA = \iint_D y \, dA $$
        因此，若需要计算 $\iint_D (x+y) \, dA$，可以直接计算 $2 \iint_D x \, dA$ 或 $2 \iint_D y \, dA$。这在计算形心坐标等问题时很有用。例如，计算 $I = \iint_D \frac{x}{x+y} dA$，同时也有 $I = \iint_D \frac{y}{x+y} dA$（将被积函数中的 $x, y$ 互换），则 $2I = \iint_D \frac{x}{x+y} dA + \iint_D \frac{y}{x+y} dA = \iint_D \frac{x+y}{x+y} dA = \iint_D 1 \, dA = \text{Area}(D)$，所以 $I = \frac{1}{2} \text{Area}(D)$。

**总结：** 在计算二重积分前，先观察积分区域 $D$ 和被积函数 $f(x, y)$ 是否具有对称性，利用这些性质往往能避免复杂的计算，甚至直接得到积分结果。

### 7.2 矩形积分区域

#### 7.2.1 拆分条件

二重积分 $\iint_D f(x,y)dA$ 可以拆分为定积分的乘积的**充分条件**是：
1.  **被积函数可分离**：$f(x,y) = g(x) \cdot h(y)$，即被积函数能表示为仅含 $x$ 的函数与仅含 $y$ 的函数的乘积。
2.  **积分区域是矩形**：$D = [a,b] \times [c,d]$，即积分区域是一个矩形，其边平行于坐标轴。

#### 7.2.2 拆分公式

当上述两个条件同时满足时，可以应用以下公式：
$$ \iint_D f(x,y)dA = \iint_D g(x)h(y)dA = \left( \int_a^b g(x)dx \right) \cdot \left( \int_c^d h(y)dy \right) $$

#### 7.2.3 例子

例如，计算 $\iint_D xy^2 dA$，其中 $D = [1,3] \times [0,2]$：
由于 $f(x,y) = xy^2 = x \cdot y^2$（函数可分离）且积分区域是矩形，所以：
$$ \iint_D xy^2 dA = \left( \int_1^3 x dx \right) \cdot \left( \int_0^2 y^2 dy \right) = \left[\frac{x^2}{2}\right]_1^3 \cdot \left[\frac{y^3}{3}\right]_0^2 = \left( \frac{9}{2} - \frac{1}{2} \right) \cdot \left( \frac{8}{3} - 0 \right) = 4 \cdot \frac{8}{3} = \frac{32}{3} $$

#### 7.2.4 注意事项

**不能拆分**的情况包括：
*   被积函数不可分离（如 $f(x,y) = x^2 + y^2$ 或 $f(x,y) = \sin(xy)$）。
*   积分区域不是矩形（如圆形区域、三角形区域等）。

在这些情况下，必须使用累次积分或其他二重积分计算方法。