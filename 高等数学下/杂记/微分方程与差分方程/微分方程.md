## 一、微分方程的定义与阶

**定义**：凡是表示未知函数、未知函数的导数或微分与自变量之间的关系的方程，称为**微分方程** (Differential Equation)，有时也简称为方程。方程中出现的未知函数最高阶导数的阶数，称为该微分方程的**阶** (Order)。

例如：
*   $y' + xy = \sin(x)$ 是一阶微分方程。
*   $y'' - 2y' + y = 0$ 是二阶微分方程。
*   $(y''')^2 + y^2 = x^4$ 是三阶微分方程。

如果方程中的未知函数是一元函数，则称为**常微分方程** (Ordinary Differential Equation, ODE)。如果未知函数是多元函数，涉及到偏导数，则称为**偏微分方程** (Partial Differential Equation, PDE)。本笔记主要讨论常微分方程。

**解**：使得微分方程成立的函数称为微分方程的解。如果解中含有任意常数的个数与方程的阶数相同，且这些常数相互独立，则称此解为**通解** (General Solution)。给这些任意常数特定值后得到的解称为**特解** (Particular Solution)。

## 二、齐次方程 (Homogeneous Equation)

齐次方程有多种定义，这里指的是形如 $M(x,y)dx + N(x,y)dy = 0$ 的方程，其中 $M(x,y)$ 和 $N(x,y)$ 是关于 $x$ 和 $y$ 的同次齐次函数。即对于任意 $\lambda \neq 0$，有 $M(\lambda x, \lambda y) = \lambda^k M(x,y)$ 和 $N(\lambda x, \lambda y) = \lambda^k N(x,y)$，其中 $k$ 为次数。

这类方程可以通过代换 $y = ux$ (或 $x = vy$) 转化为变量可分离方程。
若令 $y = ux$，则 $dy = udx + xdu$。代入原方程：
$M(x, ux)dx + N(x, ux)(udx + xdu) = 0$
$x^k M(1, u)dx + x^k N(1, u)(udx + xdu) = 0$
$M(1, u)dx + N(1, u)(udx + xdu) = 0$
$[M(1, u) + uN(1, u)]dx + xN(1, u)du = 0$
这是一个变量可分离方程：
$\frac{dx}{x} = -\frac{N(1, u)}{M(1, u) + uN(1, u)}du$
积分后将 $u = y/x$ 代回即可得到原方程的解。

另一种常见的齐次方程是指线性微分方程中的齐次情况，即方程右端项为零。例如 $y' + P(x)y = 0$。

## 三、一阶线性微分方程 (First-Order Linear Differential Equation)

形如 $y' + P(x)y = Q(x)$ 的方程称为一阶线性微分方程。
*   如果 $Q(x) \equiv 0$，则方程为**齐次**的：$y' + P(x)y = 0$。
    这是一个变量可分离方程：$\frac{dy}{y} = -P(x)dx$。
    积分得 $\ln|y| = -\int P(x)dx + C_1$，即 $y = Ce^{-\int P(x)dx}$。
*   如果 $Q(x) \not\equiv 0$，则方程为**非齐次**的。

**解法（常数变易法）**：
1.  先求对应齐次方程 $y' + P(x)y = 0$ 的通解：$y_h = Ce^{-\int P(x)dx}$。
2.  将齐次通解中的常数 $C$ 换成未知函数 $u(x)$，即设非齐次方程的解为 $y = u(x)e^{-\int P(x)dx}$。
3.  将其代入原非齐次方程 $y' + P(x)y = Q(x)$：
    $y' = u'(x)e^{-\int P(x)dx} - u(x)P(x)e^{-\int P(x)dx}$
    $u'(x)e^{-\int P(x)dx} - u(x)P(x)e^{-\int P(x)dx} + P(x)u(x)e^{-\int P(x)dx} = Q(x)$
    $u'(x)e^{-\int P(x)dx} = Q(x)$
    $u'(x) = Q(x)e^{\int P(x)dx}$
    $u(x) = \int Q(x)e^{\int P(x)dx}dx + C$
4.  代回得到非齐次方程的通解：
    $y = e^{-\int P(x)dx} \left( \int Q(x)e^{\int P(x)dx}dx + C \right)$

**公式解**：
一阶线性微分方程 $y' + P(x)y = Q(x)$ 的通解为：
$y = e^{-\int P(x)dx} \left( \int Q(x)e^{\int P(x)dx}dx + C \right)$
其中 $e^{\int P(x)dx}$ 称为积分因子。

#### 伯努利方程 (Bernoulli Equation)

形如 $y' + P(x)y = Q(x)y^n$ ($n \neq 0, 1$) 的方程称为伯努利方程。
当 $n=0$ 时，方程为线性方程。当 $n=1$ 时，方程也为线性方程。

**解法**：
1.  方程两边同除以 $y^n$ (假设 $y \neq 0$)：
    $y^{-n}y' + P(x)y^{1-n} = Q(x)$
2.  作代换 $z = y^{1-n}$，则 $z' = (1-n)y^{-n}y'$。
    所以 $y^{-n}y' = \frac{1}{1-n}z'$。
3.  代入方程得到：
    $\frac{1}{1-n}z' + P(x)z = Q(x)$
    $z' + (1-n)P(x)z = (1-n)Q(x)$
    这是一个关于 $z$ 的一阶线性微分方程。
4.  用一阶线性微分方程的公式解出 $z$，然后代回 $z = y^{1-n}$ 即可得到原方程的解。
    注意：在除以 $y^n$ 时，可能会丢失解 $y=0$。需要验证 $y=0$ 是否为原方程的解。

## 四、可降阶的高阶微分方程

某些类型的高阶微分方程可以通过适当的代换降低其阶数。

#### 1. $y^{(n)} = f(x)$ 型

这类方程可以通过逐次积分求解。
$y^{(n-1)} = \int f(x)dx + C_1$
$y^{(n-2)} = \int \left( \int f(x)dx + C_1 \right)dx + C_2 = \iint f(x)dx^2 + C_1x + C_2$
...
依此类推，积分 $n$ 次即可得到含有 $n$ 个任意常数的通解。

#### 2. $y'' = f(x, y')$ 型 (不显含 $y$)

令 $p = y'$，则 $y'' = p'$。方程化为 $p' = f(x, p)$。
这是一个关于 $p$ 的一阶微分方程。解出 $p = \phi(x, C_1)$ 后，再由 $y' = p = \phi(x, C_1)$ 积分得到 $y = \int \phi(x, C_1)dx + C_2$。

#### 3. $y'' = f(y, y')$ 型 (不显含 $x$)

令 $p = y'$，则 $y'' = \frac{dp}{dx} = \frac{dp}{dy} \cdot \frac{dy}{dx} = p \frac{dp}{dy}$。
方程化为 $p \frac{dp}{dy} = f(y, p)$。
这是一个关于 $p$ (以 $y$ 为自变量) 的一阶微分方程。解出 $p = \psi(y, C_1)$ 后，再由 $y' = p = \psi(y, C_1)$ 分离变量求解：
$\frac{dy}{\psi(y, C_1)} = dx$
$\int \frac{dy}{\psi(y, C_1)} = x + C_2$

## 五、全微分方程 (Exact Differential Equation)

形如 $M(x,y)dx + N(x,y)dy = 0$ 的方程，如果其左端恰好是某个二元函数 $u(x,y)$ 的全微分 $du(x,y) = \frac{\partial u}{\partial x}dx + \frac{\partial u}{\partial y}dy$，即
$\frac{\partial u}{\partial x} = M(x,y)$ 和 $\frac{\partial u}{\partial y} = N(x,y)$
则称该方程为**全微分方程**。其通解为 $u(x,y) = C$。

**判别条件**：如果 $M(x,y)$ 和 $N(x,y)$ 在单连通区域 $D$ 内具有一阶连续偏导数，则方程 $M(x,y)dx + N(x,y)dy = 0$ 为全微分方程的充分必要条件是：
$\frac{\partial M}{\partial y} = \frac{\partial N}{\partial x}$

**求解方法**：
1.  验证 $\frac{\partial M}{\partial y} = \frac{\partial N}{\partial x}$ 是否成立。
2.  若成立，则存在 $u(x,y)$ 使得 $\frac{\partial u}{\partial x} = M(x,y)$。积分得：
    $u(x,y) = \int M(x,y)dx + \phi(y)$，其中 $\phi(y)$ 是待定函数。
3.  对上式两边关于 $y$ 求偏导：
    $\frac{\partial u}{\partial y} = \frac{\partial}{\partial y} \left( \int M(x,y)dx \right) + \phi'(y)$
4.  由于 $\frac{\partial u}{\partial y} = N(x,y)$，所以：
    $N(x,y) = \frac{\partial}{\partial y} \left( \int M(x,y)dx \right) + \phi'(y)$
    $\phi'(y) = N(x,y) - \frac{\partial}{\partial y} \left( \int M(x,y)dx \right)$
    (理论上，上式右端应只含 $y$)
5.  积分求出 $\phi(y) = \int \left( N(x,y) - \frac{\partial}{\partial y} \left( \int M(x,y)dx \right) \right)dy$。
6.  将 $\phi(y)$ 代回 $u(x,y)$ 的表达式，则通解为 $u(x,y) = C$。

或者，也可以用曲线积分求解：
$u(x,y) = \int_{(x_0, y_0)}^{(x,y)} M(x,y)dx + N(x,y)dy$
通常选择简单的积分路径，例如从 $(x_0, y_0)$ 到 $(x, y_0)$ 再到 $(x,y)$：
$u(x,y) = \int_{x_0}^{x} M(t, y_0)dt + \int_{y_0}^{y} N(x, t)dt = C$
或从 $(x_0, y_0)$ 到 $(x_0, y)$ 再到 $(x,y)$：
$u(x,y) = \int_{y_0}^{y} N(x_0, t)dt + \int_{x_0}^{x} M(t, y)dt = C$

#### 积分因子 (Integrating Factor)

如果方程 $M(x,y)dx + N(x,y)dy = 0$ 不是全微分方程，即 $\frac{\partial M}{\partial y} \neq \frac{\partial N}{\partial x}$，有时可以找到一个函数 $\mu(x,y)$，使得方程
$\mu(x,y)M(x,y)dx + \mu(x,y)N(x,y)dy = 0$
成为一个全微分方程。这个函数 $\mu(x,y)$ 称为**积分因子**。
此时，$\frac{\partial (\mu M)}{\partial y} = \frac{\partial (\mu N)}{\partial x}$。

寻找积分因子一般比较困难，但有几种特殊情况：
1.  如果 $\frac{1}{N} \left( \frac{\partial M}{\partial y} - \frac{\partial N}{\partial x} \right) = \phi(x)$ (只含 $x$ 或为常数)，则积分因子为 $\mu(x) = e^{\int \phi(x)dx}$。
2.  如果 $\frac{1}{M} \left( \frac{\partial N}{\partial x} - \frac{\partial M}{\partial y} \right) = \psi(y)$ (只含 $y$ 或为常数)，则积分因子为 $\mu(y) = e^{\int \psi(y)dy}$。



## 六、高阶线性微分方程 (Higher-Order Linear Differential Equation)

$n$ 阶线性微分方程的一般形式为：
$a_n(x)y^{(n)} + a_{n-1}(x)y^{(n-1)} + \dots + a_1(x)y' + a_0(x)y = f(x)$
其中 $a_n(x), a_{n-1}(x), \dots, a_0(x)$ 和 $f(x)$ 是定义在某个区间 $I$ 上的已知函数，且 $a_n(x) \neq 0$。
如果 $f(x) \equiv 0$，则方程称为**齐次**的。
如果 $f(x) \not\equiv 0$，则方程称为**非齐次**的。

#### 1. 二阶齐次线性微分方程

$y'' + P(x)y' + Q(x)y = 0$

**解的结构与性质**：

*   **定理1 (叠加原理 I)**：如果 $y_1(x)$ 和 $y_2(x)$ 是二阶齐次线性方程 $y'' + P(x)y' + Q(x)y = 0$ 的两个解，那么它们的线性组合 $C_1y_1(x) + C_2y_2(x)$ (其中 $C_1, C_2$ 是任意常数) 也是该方程的解。

*   **线性相关与线性无关**：
    如果存在不全为零的常数 $k_1, k_2$ 使得 $k_1y_1(x) + k_2y_2(x) \equiv 0$ 在区间 $I$ 上成立，则称 $y_1(x)$ 和 $y_2(x)$ 在 $I$ 上**线性相关**。否则称它们**线性无关**。
    两个函数线性相关的充要条件是它们之比为常数，即 $y_1(x)/y_2(x) = \text{const}$ (若 $y_2(x) \neq 0$)。

*   **朗斯基行列式 (Wronskian)**：
    对于函数 $y_1(x)$ 和 $y_2(x)$，其朗斯基行列式定义为：
    $W(y_1, y_2)(x) = \begin{vmatrix} y_1(x) & y_2(x) \\ y_1'(x) & y_2'(x) \end{vmatrix} = y_1(x)y_2'(x) - y_1'(x)y_2(x)$

*   **定理2**：如果 $y_1(x)$ 和 $y_2(x)$ 是二阶齐次线性方程 $y'' + P(x)y' + Q(x)y = 0$ 在区间 $I$ 上的两个解 (其中 $P(x), Q(x)$ 在 $I$ 上连续)，则 $y_1(x)$ 和 $y_2(x)$ 在 $I$ 上线性无关的充要条件是它们的朗斯基行列式 $W(y_1, y_2)(x) \neq 0$ 对 $I$ 上的任意 $x$ 成立。
    (实际上，对于齐次线性方程的解，若 $W(x_0) \neq 0$ 于某点 $x_0 \in I$，则 $W(x) \neq 0$ 于 $I$ 上所有点。)

*   **基本解组 (Fundamental Set of Solutions)**：
    如果 $y_1(x)$ 和 $y_2(x)$ 是二阶齐次线性方程的两个线性无关的解，则称 $\{y_1(x), y_2(x)\}$ 是该方程的一个基本解组。

*   **定理3 (通解结构)**：如果 $y_1(x)$ 和 $y_2(x)$ 是二阶齐次线性方程 $y'' + P(x)y' + Q(x)y = 0$ 的一个基本解组，则该方程的通解为 $y_h = C_1y_1(x) + C_2y_2(x)$，其中 $C_1, C_2$ 是任意常数。

*   **定理4 (叠加性)**：这通常指的就是定理1，即解的线性组合仍然是解。

#### 2. 二阶非齐次线性微分方程

$y'' + P(x)y' + Q(x)y = f(x)$ (其中 $f(x) \not\equiv 0$)

**解的结构**：
如果 $y^*(x)$ 是非齐次方程的一个特解，而 $y_h = C_1y_1(x) + C_2y_2(x)$ 是对应的齐次方程 $y'' + P(x)y' + Q(x)y = 0$ 的通解，则非齐次方程的通解为：
$y = y_h + y^*(x) = C_1y_1(x) + C_2y_2(x) + y^*(x)$

**叠加原理 II (非齐次方程的解的叠加)**：
如果 $y_1^*(x)$ 是方程 $y'' + P(x)y' + Q(x)y = f_1(x)$ 的一个特解，
而 $y_2^*(x)$ 是方程 $y'' + P(x)y' + Q(x)y = f_2(x)$ 的一个特解，
则 $y_1^*(x) + y_2^*(x)$ 是方程 $y'' + P(x)y' + Q(x)y = f_1(x) + f_2(x)$ 的一个特解。

**求特解的方法**：
*   **常数变易法 (Variation of Parameters)**：
    如果已知对应齐次方程的通解 $y_h = C_1y_1(x) + C_2y_2(x)$，则可以设非齐次方程的特解为 $y^*(x) = u_1(x)y_1(x) + u_2(x)y_2(x)$。
    其中 $u_1(x)$ 和 $u_2(x)$ 满足方程组：
    $\begin{cases} u_1'y_1 + u_2'y_2 = 0 \\ u_1'y_1' + u_2'y_2' = f(x) \end{cases}$
    解出 $u_1'$ 和 $u_2'$ 后积分得到 $u_1(x)$ 和 $u_2(x)$ (积分常数可取0)，代回即可得到 $y^*(x)$。
    $u_1'(x) = -\frac{y_2(x)f(x)}{W(y_1, y_2)(x)}$
    $u_2'(x) = \frac{y_1(x)f(x)}{W(y_1, y_2)(x)}$

## 七、常系数齐次线性微分方程

形如 $ay'' + by' + cy = 0$ 的方程，其中 $a, b, c$ 是常数且 $a \neq 0$。
（更一般地，$a_n y^{(n)} + a_{n-1} y^{(n-1)} + \dots + a_1 y' + a_0 y = 0$）

**特征方程法**：
假设解的形式为 $y = e^{rx}$，代入方程得：
$ar^2e^{rx} + bre^{rx} + ce^{rx} = 0$
$e^{rx}(ar^2 + br + c) = 0$
由于 $e^{rx} \neq 0$，所以 $ar^2 + br + c = 0$。
这个代数方程称为**特征方程**。

根据特征方程的根的情况，通解有以下三种形式：
1.  **两个不相等的实根 $r_1, r_2$** ($\Delta = b^2 - 4ac > 0$)：
    通解为 $y = C_1e^{r_1x} + C_2e^{r_2x}$。
2.  **两个相等的实根 $r_1 = r_2 = r$** ($\Delta = b^2 - 4ac = 0$)：
    通解为 $y = (C_1 + C_2x)e^{rx}$。
3.  **一对共轭复根 $r_{1,2} = \alpha \pm i\beta$** ($\Delta = b^2 - 4ac < 0$)：
    通解为 $y = e^{\alpha x}(C_1\cos(\beta x) + C_2\sin(\beta x))$。

对于 $n$ 阶常系数齐次线性微分方程，类似地，其特征方程为 $a_n r^n + a_{n-1} r^{n-1} + \dots + a_1 r + a_0 = 0$。
*   若 $r$ 是特征方程的 $k$ 重实根，则通解中包含项 $(C_1 + C_2x + \dots + C_k x^{k-1})e^{rx}$。
*   若 $\alpha \pm i\beta$ 是特征方程的一对 $k$ 重共轭复根，则通解中包含项 $e^{\alpha x}[(P_{k-1}(x)\cos(\beta x) + Q_{k-1}(x)\sin(\beta x)]$，其中 $P_{k-1}(x)$ 和 $Q_{k-1}(x)$ 是任意的 $k-1$ 次多项式。

## 八、常系数非齐次线性微分方程

形如 $ay'' + by' + cy = f(x)$ 的方程，其中 $a, b, c$ 是常数且 $a \neq 0$。
（更一般地，$a_n y^{(n)} + a_{n-1} y^{(n-1)} + \dots + a_1 y' + a_0 y = f(x)$）

通解结构为 $y = y_h + y^*$，其中 $y_h$ 是对应齐次方程的通解，$y^*$ 是非齐次方程的一个特解。
$y_h$ 的求法见上一节。关键在于求 $y^*$。

**待定系数法 (Method of Undetermined Coefficients)**：
此方法适用于 $f(x)$ 具有特定形式的情况，主要是以下两种类型：
1.  $f(x) = P_m(x)e^{\lambda x}$
    其中 $P_m(x)$ 是 $m$ 次多项式。
    *   如果 $\lambda$ 不是特征方程的根，则设特解 $y^* = Q_m(x)e^{\lambda x}$，其中 $Q_m(x)$ 是与 $P_m(x)$ 同次的待定系数多项式。
    *   如果 $\lambda$ 是特征方程的 $k$ 重根，则设特解 $y^* = x^k Q_m(x)e^{\lambda x}$。

2.  $f(x) = e^{\alpha x}[P_l(x)\cos(\beta x) + P_n(x)\sin(\beta x)]$
    其中 $P_l(x)$ 是 $l$ 次多项式，$P_n(x)$ 是 $n$ 次多项式。令 $m = \max(l, n)$。
    *   如果 $\alpha \pm i\beta$ 不是特征方程的根，则设特解 $y^* = e^{\alpha x}[Q_m^{(1)}(x)\cos(\beta x) + Q_m^{(2)}(x)\sin(\beta x)]$，其中 $Q_m^{(1)}(x)$ 和 $Q_m^{(2)}(x)$ 是 $m$ 次待定系数多项式。
    *   如果 $\alpha \pm i\beta$ 是特征方程的 $k$ 重根，则设特解 $y^* = x^k e^{\alpha x}[Q_m^{(1)}(x)\cos(\beta x) + Q_m^{(2)}(x)\sin(\beta x)]$。

将设出的 $y^*$ 代入原方程，比较两边同类项系数，确定待定系数。

**注意**：如果 $f(x)$ 是几项之和，例如 $f(x) = f_1(x) + f_2(x)$，可以分别求出对应 $f_1(x)$ 和 $f_2(x)$ 的特解 $y_1^*$ 和 $y_2^*$，则原方程的特解为 $y^* = y_1^* + y_2^*$ (叠加原理)。

如果 $f(x)$ 的形式不适用待定系数法，或者系数不是常数，则应使用**常数变易法** (见二阶非齐次线性微分方程部分，可推广到高阶)。
