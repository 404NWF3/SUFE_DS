## 摘要

变参数法把齐次解中“常数”升级为“函数”，再用 **Wronskian/Cramer 结构**把未知函数的导数显式求出；只要能完成两次积分，就能构造出任何右端 $g(x)$ 下的特解。该方法不受右端类型限制，是常系数线性 ODE/ODE 系统的通用“后备武器”，但计算量取决于积分难度。(

---

## 1  预备：把方程写到“标准形”

给定二阶常系数非齐次方程

$$
a\,y''+b\,y'+c\,y=g(x),\qquad a\neq0,
$$

先除以 $a$ ，将最高阶项系数归一化：

$$
y''+p\,y'+q\,y=g(x),\qquad p=\tfrac{b}{a},\;q=\tfrac{c}{a}.:contentReference[oaicite:1]{index=1}
$$

> **理由** — Wronskian公式只在这一标准形下直接成立。([tutorial.math.lamar.edu][1])

---

## 2  核心思想

1. **先解齐次方程**
   $y''+p\,y'+q\,y=0$ 的两线性无关解 $y_1,y_2$ 可由特征方程得到（常系数场景下总能做到）。([tutorial.math.lamar.edu][3])
2. **“常数”变“参数”**
   设特解形如 $y_p=u_1(x)\,y_1+u_2(x)\,y_2$。([en.wikipedia.org][2])
3. **附加约束**
   impose $u_1'y_1+u_2'y_2=0$ —— 这是经典约束，目的是少写一阶导数，方便求解。([tutorial.math.lamar.edu][1])
4. **建立两元一次方程组**

$$
\begin{cases}
u_1'y_1+u_2'y_2=0,\\
u_1'y_1'+u_2'y_2'=g(x).
\end{cases}
$$

5. **用 Cramer/Wronskian 解未知导数**

$$
u_1'=-\dfrac{y_2\,g}{W},\qquad 
u_2'= \dfrac{y_1\,g}{W},\qquad 
W=y_1y_2'-y_1'y_2\neq0.:contentReference[oaicite:6]{index=6}
$$

> 此处的 $W$ 是 Wronskian；分母非零保证基解组线性无关。([ecampusontario.pressbooks.pub][4])

6. **两次积分得到 $u_1,u_2$**
   $u_i(x)=\int u_i'(x)\,dx$（积分常数可并入齐次解）。([tutorial.math.lamar.edu][1])
7. **拼装完整通解**
   $y(x)=C_1y_1+C_2y_2+y_p$。

---

## 3  步骤清单（第二阶常系数版）

| # | 动作                                               | 工具/公式       |
| - | ------------------------------------------------ | ----------- |
| 1 | 求特征根 $r_{1,2}$ → 齐次解 $y_1=e^{r_1x},y_2=e^{r_2x}$ | 特征方程        |
| 2 | 写出 Wronskian $W=y_1y_2'-y_1'y_2$                 | 行列式定义       |
| 3 | 列方程组求 $u_1',u_2'$                                | 见上式         |
| 4 | 计算两个积分                                           | 视 $g(x)$ 而定 |
| 5 | 形成 $y_p=u_1y_1+u_2y_2$                           | 线性叠加        |
| 6 | 最终结果 $y=y_h+y_p$                                 | 叠加原理        |

> **实践要点**：如果 $g(x)$ 本身含 $e^{\pm r_ix}$，不用担心共振问题——变参数法天然避免“重根加乘 $x$”的处理。([mathsisfun.com][5])

---

## 4  向高阶与系统推广

### 4.1  $n$ 阶单方程

令 $\{y_1,\dots,y_n\}$ 为齐次解基，$\Phi(x)$ 为它们组成的 **Fundamental Matrix**；则

$$
\boxed{\,y_p=\Phi(x)\int \Phi^{-1}(x)\,\mathbf{e}_n\,g(x)\,dx\,},\qquad 
\mathbf{e}_n=(0,\dots,0,1)^{\mathsf T}.:contentReference[oaicite:10]{index=10}
$$

### 4.2  线性系统 $\mathbf{y}'=A\mathbf{y}+\mathbf{f}(x)$

若 $\Phi(x)$ 满足 $\Phi' = A\Phi$（即齐次系统的基解矩阵），则

$$
\boxed{\,\mathbf{y}_p(x)=\Phi(x)\int_{x_0}^{x}\Phi^{-1}(s)\mathbf{f}(s)\,ds\,}.:contentReference[oaicite:11]{index=11}
$$

---

## 5  与“待定系数”法比较

| 维度 | 变参数法 | 待定系数法 |
|------|---------|-----------|
|适用右端|任何可积函数 $g(x)$|多项式、指数、正余弦及其有限线性组合|
|前置需求|必须先得齐次基解|最好知道，但非强制|
|计算量|两次积分，积分难度不定|仅解线性方程组|
|保证成功性|理论上总能写出公式|若 $g$ 不在可猜测族内则失效|:contentReference[oaicite:12]{index=12}

---

## 6  实战技巧与坑

1. **提前检查 Wronskian**：常系数情形下 $W\propto e^{(r_1+r_2)x}$ 永不为零，可放心使用；变系数时需验证。:contentReference[oaicite:13]{index=13}  
2. **积分策略**：  
   - 若 $g(x)$ 与 $y_1,y_2$ 同类，先用代换把分子简化。  
   - 对指数型右端，指数代换 $t=e^{\alpha x}$ 常能线性化分式。  
3. **高阶/系统公式实现**：实际计算常使用 **Cramer 行列式模板** 配合符号计算软件，避免手算逆矩阵。  
4. **边界/初值问题**：常数 $C_i$ 仍由初值条件确定，不受变参数构造影响。  

---

## 7  速查表

- **二阶公式**  

$$
\boxed{
\begin{aligned}
u_1'&=-\frac{y_2\,g}{W},\quad u_2'=\frac{y_1\,g}{W},\\[4pt]
y_p&=u_1y_1+u_2y_2.
\end{aligned}}
$$

* **$n$ 阶或系统公式**

$$
\boxed{\mathbf{y}_p=\Phi\,\int\!\Phi^{-1}\mathbf{f}}.
$$

* **Wronskian** $W=\det\begin{pmatrix}y_1 & y_2\\ y_1' & y_2'\end{pmatrix}$.

* **使用时机**：右端“怪”或含分式、双曲函数、分段函数、Bessel 等特殊函数时，直接上变参数法。

---

**结论**：变参数法是一把“万用扳手”——不挑右端、原理统一、公式清晰；缺点只是积分费劲。熟练掌握后，只要能算得动积分，就能硬解任何常系数线性 ODE / ODE 系统。

[1]: https://tutorial.math.lamar.edu/classes/de/VariationofParameters.aspx "
	Differential Equations - Variation of Parameters
"
[2]: https://en.wikipedia.org/wiki/Variation_of_parameters?utm_source=chatgpt.com "Variation of parameters"
[3]: https://tutorial.math.lamar.edu/classes/de/VariationofParameters.aspx?utm_source=chatgpt.com "Differential Equations - Variation of Parameters"
[4]: https://ecampusontario.pressbooks.pub/diffeq/chapter/3-5-method-of-variation-of-parameters/?utm_source=chatgpt.com "3.5 Method of Variation of Parameters – Differential Equations"
[5]: https://www.mathsisfun.com/calculus/differential-equations-variation-parameters.html?utm_source=chatgpt.com "The Method of Variation of Parameters - Math is Fun"
